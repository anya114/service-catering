<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="build.dream.erp.mappers.TenantMapper">
    <insert id="insert" parameterType="build.dream.common.saas.domains.Tenant" useGeneratedKeys="false">
        INSERT INTO tenant(code, name) VALUES (#{code}, #{name})
    </insert>

    <select id="findAll" resultType="build.dream.erp.domains.Tenant">
        <include refid="paginationHeader"></include>
        SELECT tenant.*, ROWNUM as row_num FROM tenant
        <include refid="paginationFooter"></include>
        <!--SELECT * FROM tenant
        <include refid="mysqlPaginationFooter"></include>-->
    </select>

    <select id="countAll" resultType="java.lang.Long">
        SELECT COUNT(1) FROM tenant
    </select>

    <sql id="paginationHeader">
        SELECT * FROM (
    </sql>

    <sql id="paginationFooter">
        <bind name="start" value="(pageNumber - 1) * pageSize + 1"></bind>
        <bind name="end" value="start + pageSize - 1"></bind>
        ) WHERE row_num &gt;= #{start} AND row_num &lt;= #{end}
    </sql>

    <sql id="mysqlPaginationFooter">
        <bind name="offset" value="(pageNumber - 1) * pageSize"></bind>
        LIMIT #{offset}, #{pageSize}
    </sql>
</mapper>